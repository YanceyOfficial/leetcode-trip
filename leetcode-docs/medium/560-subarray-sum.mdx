---
id: 560-subarray-sum
title: å’Œä¸ºkçš„å­æ•°ç»„
sidebar_label: 560. å’Œä¸ºkçš„å­æ•°ç»„
keywords:
  - å‰ç¼€å’Œ
---

:::success Tips
é¢˜ç›®ç±»å‹: å‰ç¼€å’Œ

ç›¸å…³é¢˜ç›®: 

- [523. è¿ç»­çš„å­æ•°ç»„å’Œ](/leetcode/medium/523-check-subarray-sum)
- [930. å’Œç›¸åŒçš„äºŒå…ƒå­æ•°ç»„](/leetcode/medium/930-num-subarrays-with-sum)
:::

## é¢˜ç›®

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„å’Œä¸€ä¸ªæ•´æ•° k, ä½ éœ€è¦æ‰¾åˆ°è¯¥æ•°ç»„ä¸­å’Œä¸º k çš„**è¿ç»­**çš„å­æ•°ç»„çš„ä¸ªæ•°.

:::info ç¤ºä¾‹

è¾“å…¥: nums = [1, 1, 1], k = 2

è¾“å‡º: 2

è§£é‡Š: [1, 1] ä¸ [1, 1] ä¸ºä¸¤ç§ä¸åŒçš„æƒ…å†µ.
:::

## é¢˜è§£

### æš´åŠ›æ³• ğŸ¸

æš´åŠ›æ³•æ ¸å¿ƒå°±æ˜¯æ•´ä¸ªåŒå¾ªç¯ç©·å°½æ‰€æœ‰å­æ•°ç»„, å¦‚æœè¿™ä¸ªå­æ•°ç»„çš„å’Œç­‰äº k, é‚£å°±è®© count++, ç›´åˆ°å¾ªç¯å®Œæ¯•.

```ts
var subarraySum = function (nums, k) {
  const len = nums.length
  let count = 0

  for (let i = 0; i < len; ++i) {
    let sum = 0
    for (let j = i; j < len; ++j) {
      sum += nums[j]
      if (sum === k) count++
    }
  }

  return count
}
```

### æš´åŠ›å‰ç¼€å’Œ ğŸ¸

è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯**å‰ç¼€å’Œ**, å‰ç¼€å’Œçš„ä»£ç å¦‚ä¸‹, å¦‚æœæˆ‘ä»¬æƒ³æ±‚ nums[i] åˆ° nums[j] çš„å’Œ, å¯ä»¥ä½¿ç”¨ `preSum[j + 1] - preSum[i]` å¾—å‡º.

```ts
nums = [3, 5, 2, -2, 4, 1]
preSum = [0, 3, 8, 10, 8, 12, 13]
```

```ts
var getPreSum = function (nums) {
  const len = nums.length
  const preSum = new Array(len + 1).fill(0)

  // æ„é€ å‰ç¼€å’Œ
  for (let i = 0; i < len; i++) {
    preSum[i + 1] = preSum[i] + nums[i]
  }

  return preSum
}
```

è¿™é“é¢˜å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç è§£å†³, ä½†åœ¨ leetcode æäº¤æ—¶æç¤ºè¶…æ—¶, åŸå› å°±æ˜¯ç©·å°½æ‰€æœ‰å­æ•°ç»„æ—¶æ•´äº†ä¸ªåŒå¾ªç¯, æ—¶é—´å¤æ‚åº¦ä»ç„¶æ˜¯ O(n<sup>2</sup>).

```ts
/**
 * @param {number[]} nums
 * @param {number} k
 * @return {number}
 */
var subarraySum = function (nums, k) {
  const len = nums.length
  const preSum = new Array(len + 1).fill(0)

  // æ„é€ å‰ç¼€å’Œ
  for (let i = 0; i < len; i++) {
    preSum[i + 1] = preSum[i] + nums[i]
  }

  let count = 0
  // ç©·ä¸¾æ‰€æœ‰å­æ•°ç»„
  for (let left = 0; left < len; left++) {
    for (let right = left; right < len; right++) {
      // åˆ©ç”¨å‰ç¼€å’Œçš„æ€§è´¨
      if (preSum[right + 1] - preSum[left] === k) {
        count++
      }
    }
  }

  return count
}
```

### å‰ç¼€å’Œ + HashMap

- è®¾ `pre[i]` ä¸º `pre[0..i]` æ‰€æœ‰å…ƒç´ çš„å’Œ, é‚£ä¹ˆ `pre[i] = pre[i - 1] + nums[i]`, å› ä¸º `pre[i]` å¯ä»¥ç”± `pre[i - 1]` é€’æ¨è¿‡æ¥
- åŒç†, **pre[j..i] è¿™ä¸ªå­æ•°ç»„å’Œä¸º k** è¿™ä¸ªæ¡ä»¶å¯ä»¥è½¬åŒ–ä¸º `pre[i] - pre[j - 1] = k`
- ä¸Šé¢çš„å…¬å¼ä¹Ÿå°±æ˜¯ `pre[j - 1] = pre[i] - k`

![560-subarray-sum](../../static/img/560-subarray-sum-0.png)

ä¸Šé¢è¿™ä¸ªå›¾å°±å¾ˆæ¸…æ™°, `presum - k` å…¶å®å°±æ˜¯å­ä¸²çš„å’Œ, æˆ‘ä»¬çš„ç›®çš„æ˜¯è®¡ç®— `pre[i] - k` æ˜¯å¦ç­‰äº `presum - k`. æ¢å¥è¯è¯´, å°±æ˜¯åœ¨æ€»å’Œé‡Œå‡å» k æ˜¯å¦å­˜åœ¨, å¦‚æœå­˜åœ¨, é‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªå’Œä¸º k çš„å­æ•°ç»„. å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡å»ºç«‹ä¸€ä¸ª hash è¡¨, å°† `pre[i] - k` è®¾ä¸º key, è€Œè¿™ä¸ª key **å‡ºç°çš„æ¬¡æ•°**ä½œä¸º val, è€Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„æ˜¯ç»Ÿè®¡ val.

import Carousel from 'nuka-carousel'
import { randomSeries } from 'yancey-js-util'
import useBaseUrl from '@docusaurus/useBaseUrl'

<Carousel
  style={{ margin: '48px 0', padding: '24px 0' }}
  renderBottomCenterControls={null}
>
  {new Array(9).fill(randomSeries(6)).map((val, index) => (
    <img
      key={val}
      src={useBaseUrl(`/img/560-subarray-sum-${index + 1}.png`)}
    />
  ))}
</Carousel>

```ts
var subarraySum = function (nums, k) {
  // å‰ç¼€å’Œè¦åˆå§‹åŒ–ä¸€ä¸ª key ä¸º 0, å› ä¸ºåˆå§‹åŒ–äº†ä¸€ä¸ª 0, æ‰€ä»¥å®ƒå‡ºç°çš„æ¬¡æ•°å°±æ˜¯ 1
  const map = new Map([[0, 1]])

  let sum = 0
  let count = 0

  for (const num of nums) {
    sum += num
    if (map.has(sum - k)) {
      count += map.get(sum - k)
    }

    if (map.has(sum)) {
      map.set(sum, map.get(sum) + 1)
    } else {
      map.set(sum, 1)
    }
  }

  return count
}
```
